<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.egeo.components.product.dao.read.ProductReadDAO">
	<select id="queryProductsByIds" resultMap="productMap">
		select * from product
		where id 
		<include refid="inClause" />
	</select>

	<sql id="inClause">
		in
		<foreach collection="ids" item="id" open="(" separator="," close=")">
		#{id}
	</foreach>
	</sql>

	<resultMap type="com.egeo.components.product.po.ProductPO" id="productMap">
		<result property="id" column="id" />
		<result property="productSerialNumber" column="product_serial_number" />
		<result property="productCategory" column="product_category" />
		<result property="brandId" column="brand_id" />
		<result property="categoryTreeNodeId" column="category_tree_node_id" />
		<result property="title" column="title" />
		<result property="name" column="name" />
		<result property="chineseName" column="chinese_name" />
		<result property="taxNo" column="tax_no" />
		<result property="eanNo" column="ean_no" />
		<result property="placeOfOrigin" column="place_of_origin" />
		<result property="calculationUnit" column="calculation_unit" />
		<result property="status" column="status" />
		<result property="productDetails" column="product_details" />
		<result property="marketPrice" column="market_price" />
		<result property="isAvailable" column="is_available" />
		<result property="createTime" column="create_time" />
		<result property="updateTime" column="update_time" />
		<result property="enterpriseId" column="enterprise_id" />
		<result property="supplierId" column="supplier_id" />
		<result property="priceDetail" column="price_detail" />
		<result property="platformId" column="platform_id" />
		<result property="referlink" column="referlink" />
		<result property="extend" column="extend" />
		<result property="commodityTemplateId" column="commodity_template_id" />
	</resultMap>
	
	<resultMap type="com.egeo.components.product.condition.ProductCondition" id="productCondition" extends="productMap">
		<result property="content" column="content" />
	</resultMap>

	<sql id="productColumns">
		id,
		product_serial_number,
		product_category,
		brand_id,
		category_tree_node_id,
		title,
		name,
		chinese_name,
		market_price,
		is_available,
		tax_no,
		ean_no,
		place_of_origin,
		calculation_unit,
		status,
		product_details,
		create_time,
		update_time,
		enterprise_id,
		supplier_id,
		price_detail,
		referlink,
		extend,
		platform_id
	</sql>

	<select id="findById" parameterType="com.egeo.components.product.po.ProductPO" resultMap="productMap">
		SELECT
		<include refid="productColumns" />
		FROM product
		WHERE id = #{po.id}
	</select>

	<select id="findLastId"  resultType="java.lang.Long">
		select MAX(id) from  product
	</select>

	<select id="findOfPage" resultMap="productMap">
		select pro.* from
			( select * from product p,
				( select DISTINCT(pn.product_id) from product_att_name pn, product_att_value pv
				<where>
					<if test="true">
						and pn.id = pv.product_att_name_id
					</if>
					<!--<if test="true">
						and pv.att_value_custom is not null
					</if>-->
					<if test="po.precautiousStart != null or po.precautiousEnd != null">
						AND pn.att_name_id IN (6,7,8)
					</if>
					<if test="po.precautiousStart != null">
						and CAST(pv.att_value_custom AS SIGNED) &gt;= #{po.precautiousStart}
					</if>
					<if test="po.precautiousEnd != null">
						and CAST(pv.att_value_custom AS SIGNED) &lt;= #{po.precautiousEnd}
					</if>
				</where>
				 ) a
			 where p.id=a.product_id
			) pro

			<where>
				<if test="true">
					and name is not null
				</if>
				<if test="po.productSerialNumber != null">
					and product_serial_number = #{po.productSerialNumber}
				</if>
				<if test="po.brandId != null">
					and brand_id = #{po.brandId}
				</if>
				<if test="po.categoryTreeNodeId != null">
					and category_tree_node_id = #{po.categoryTreeNodeId}
				</if>
				<if test="po.title != null">
					and title = #{po.title}
				</if>
				<if test="po.name != null">
					and name like concat('%',#{po.name},'%')
				</if>
				<if test="po.chineseName != null">
					and chinese_name = #{po.chineseName}
				</if>
				<if test="po.taxNo != null">
					and tax_no = #{po.taxNo}
				</if>
				<if test="po.eanNo != null">
					and ean_no = #{po.eanNo}
				</if>
				<if test="po.placeOfOrigin != null">
					and place_of_origin = #{po.placeOfOrigin}
				</if>
				<if test="po.calculationUnit != null">
					and calculation_unit = #{po.calculationUnit}
				</if>
				<if test="po.status != null">
					and status = #{po.status}
				</if>
				<if test="po.productDetails != null">
					and product_details = #{po.productDetails}
				</if>
				<if test="po.createTime != null">
					and create_time = #{po.createTime}
				</if>
				<if test="po.beginTime != null">
					and  create_time > #{po.beginTime}
				</if>
				<if test="po.finishTime != null">
					and  #{po.finishTime} > create_time
				</if>
				<if test="po.updateTime != null">
					and update_time = #{po.updateTime}
				</if>
				<if test="po.enterpriseId != null">
					and enterprise_id = #{po.enterpriseId}
				</if>
				<if test="po.supplierId != null">
					and supplier_id = #{po.supplierId}
				</if>
				<if test="po.priceDetail != null">
					and price_detail = #{po.priceDetail}
				</if>
				<if test="po.platformId != null">
					and platform_id = #{po.platformId}
				</if>
			</where>
			<choose>
				<when test="page !=null and page.orderBy != null and page.orderBy != ''">
					ORDER BY ${page.orderBy}
				</when>
				<otherwise>
					ORDER BY id desc
				</otherwise>
			</choose>
			<if test="page != null">
			limit #{page.limitStart},#{page.pageSize}
			</if>
	</select>

	<select id="productByActivityId" resultMap="productMap">
		SELECT
		<include refid="productColumns" />
		FROM product
		<where>
			<if test="po.productSerialNumber != null">
				and product_serial_number = #{po.productSerialNumber}
			</if>
			<if test="po.brandId != null">
				and brand_id = #{po.brandId}
			</if>
			<if test="po.categoryTreeNodeId != null">
				and category_tree_node_id = #{po.categoryTreeNodeId}
			</if>
			<if test="po.title != null">
				and title = #{po.title}
			</if>
			<if test="po.name != null">
				and name like concat('%',#{po.name},'%') 
			</if>
			<if test="po.chineseName != null">
				and chinese_name = #{po.chineseName}
			</if>
			<if test="po.taxNo != null">
				and tax_no = #{po.taxNo}
			</if>
			<if test="po.eanNo != null">
				and ean_no = #{po.eanNo}
			</if>
			<if test="po.placeOfOrigin != null">
				and place_of_origin = #{po.placeOfOrigin}
			</if>
			<if test="po.calculationUnit != null">
				and calculation_unit = #{po.calculationUnit}
			</if>
			<if test="po.platformId != null">
				and platform_id = #{po.platformId}
			</if>
				<if test="po.enterpriseId != null">
					and enterprise_id = #{po.enterpriseId}
				</if>
				<if test="po.supplierId != null">
					and supplier_id = #{po.supplierId}
				</if>
				
				<if test="po.priceDetail != null">
					and price_detail = #{po.priceDetail}
				</if>
			<if test="po.status != null">
				and status = #{po.status}
			</if>
			<if test="po.productDetails != null">
				and product_details = #{po.productDetails}
			</if>
			<if test="po.createTime != null">
				and create_time = #{po.createTime}
			</if>
			<if test="po.beginTime != null">
				and  create_time > #{po.beginTime} 
			</if>
			<if test="po.finishTime != null">
				and  #{po.finishTime} > create_time
			</if>
			<if test="po.updateTime != null">
				and update_time = #{po.updateTime}
			</if>
			<if test="po.ids != null">
				and id not in (${po.ids})
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>		
			<otherwise>
				ORDER BY id desc		
			</otherwise>
		</choose>
		<if test="page != null">
		limit #{page.limitStart},#{page.pageSize}
		</if>
	</select>
	
	<select id="countOfPage" resultType="java.lang.Integer">
		SELECT
		count(1) cnt
		from
		( select pro.* from
			( select * from product p,
				( select DISTINCT(pn.product_id) from product_att_name pn, product_att_value pv
				<where>
					<if test="true">
						and pn.id = pv.product_att_name_id
					</if>
					<!--<if test="true">
						and pv.att_value_custom is not null
					</if>-->
					<if test="po.precautiousStart != null or po.precautiousEnd != null ">
						AND pn.att_name_id IN (6,7,8)
					</if>
					<if test="po.precautiousStart != null">
						and CAST(pv.att_value_custom AS SIGNED) &gt;= #{po.precautiousStart}
					</if>
					<if test="po.precautiousEnd != null">
						and CAST(pv.att_value_custom AS SIGNED) &lt;= #{po.precautiousEnd}
					</if>
				</where>
				) a
		where p.id=a.product_id
		) pro

		<where>
			<if test="true">
				and name is not null
			</if>
			<if test="po.productSerialNumber != null">
				and product_serial_number = #{po.productSerialNumber}
			</if>
			<if test="po.brandId != null">
				and brand_id = #{po.brandId}
			</if>
			<if test="po.categoryTreeNodeId != null">
				and category_tree_node_id = #{po.categoryTreeNodeId}
			</if>
			<if test="po.title != null">
				and title = #{po.title}
			</if>
			<if test="po.name != null">
				and name like concat('%',#{po.name},'%')
			</if>
			<if test="po.chineseName != null">
				and chinese_name = #{po.chineseName}
			</if>
			<if test="po.taxNo != null">
				and tax_no = #{po.taxNo}
			</if>
			<if test="po.eanNo != null">
				and ean_no = #{po.eanNo}
			</if>
			<if test="po.placeOfOrigin != null">
				and place_of_origin = #{po.placeOfOrigin}
			</if>
			<if test="po.calculationUnit != null">
				and calculation_unit = #{po.calculationUnit}
			</if>
			<if test="po.status != null">
				and status = #{po.status}
			</if>
			<if test="po.productDetails != null">
				and product_details = #{po.productDetails}
			</if>
			<if test="po.createTime != null">
				and create_time = #{po.createTime}
			</if>
			<if test="po.beginTime != null">
				and  create_time > #{po.beginTime}
			</if>
			<if test="po.finishTime != null">
				and  #{po.finishTime} > create_time
			</if>
			<if test="po.updateTime != null">
				and update_time = #{po.updateTime}
			</if>
			<if test="po.platformId != null">
				and platform_id = #{po.platformId}
			</if>
				<if test="po.enterpriseId != null">
					and enterprise_id = #{po.enterpriseId}
				</if>
				<if test="po.supplierId != null">
					and supplier_id = #{po.supplierId}
				</if>
				
				<if test="po.priceDetail != null">
					and price_detail = #{po.priceDetail}
				</if>
		</where>

		) proSize
	</select>

	<select id="productByActivityIdCount" resultType="java.lang.Integer">
		SELECT
		count(1) cnt
		FROM product
		<where>
			<if test="po.brandId != null">
				and brand_id = #{po.brandId}
			</if>
			<if test="po.categoryTreeNodeId != null">
				and category_tree_node_id = #{po.categoryTreeNodeId}
			</if>
			<if test="po.title != null">
				and title = #{po.title}
			</if>
			<if test="po.name != null">
				and name like concat('%',#{po.name},'%') 
			</if>
			<if test="po.chineseName != null">
				and chinese_name = #{po.chineseName}
			</if>
			<if test="po.taxNo != null">
				and tax_no = #{po.taxNo}
			</if>
			<if test="po.eanNo != null">
				and ean_no = #{po.eanNo}
			</if>
			<if test="po.placeOfOrigin != null">
				and place_of_origin = #{po.placeOfOrigin}
			</if>
			<if test="po.calculationUnit != null">
				and calculation_unit = #{po.calculationUnit}
			</if>
			<if test="po.platformId != null">
				and platform_id = #{po.platformId}
			</if>
				<if test="po.enterpriseId != null">
					and enterprise_id = #{po.enterpriseId}
				</if>
				<if test="po.supplierId != null">
					and supplier_id = #{po.supplierId}
				</if>
				
				<if test="po.priceDetail != null">
					and price_detail = #{po.priceDetail}
				</if>
			<if test="po.status != null">
				and status = #{po.status}
			</if>
			<if test="po.productDetails != null">
				and product_details = #{po.productDetails}
			</if>
			<if test="po.createTime != null">
				and create_time = #{po.createTime}
			</if>
			<if test="po.createTime != null">
				and create_time = #{po.createTime}
			</if>
			<if test="po.beginTime != null">
				and  create_time > #{po.beginTime} 
			</if>
			<if test="po.finishTime != null">
				and  #{po.finishTime} > create_time
			</if>
			<if test="po.updateTime != null">
				and update_time = #{po.updateTime}
			</if>
			<if test="po.ids != null">
				and id not in (${po.ids})
			</if>
		</where>
	</select>
	
	<select id="findAll" resultMap="productMap">
		SELECT
		<include refid="productColumns" />
		FROM product
		<where>
			<if test="po.brandId != null">
				and brand_id = #{po.brandId}
			</if>
			<if test="po.categoryTreeNodeId != null">
				and category_tree_node_id = #{po.categoryTreeNodeId}
			</if>
			<if test="po.title != null">
				and title = #{po.title}
			</if>
			<if test="po.name != null">
				and name = #{po.name}
			</if>
			<if test="po.chineseName != null">
				and chinese_name = #{po.chineseName}
			</if>
			<if test="po.taxNo != null">
				and tax_no = #{po.taxNo}
			</if>
			<if test="po.eanNo != null">
				and ean_no = #{po.eanNo}
			</if>
			<if test="po.placeOfOrigin != null">
				and place_of_origin = #{po.placeOfOrigin}
			</if>
			<if test="po.calculationUnit != null">
				and calculation_unit = #{po.calculationUnit}
			</if>
			<if test="po.status != null">
				and status = #{po.status}
			</if>
			<if test="po.productDetails != null">
				and product_details = #{po.productDetails}
			</if>
			<if test="po.createTime != null">
				and create_time = #{po.createTime}
			</if>
			<if test="po.createTime != null">
				and create_time = #{po.createTime}
			</if>
			<if test="po.beginTime != null">
				and  create_time > #{po.beginTime} 
			</if>
			<if test="po.finishTime != null">
				and  #{po.finishTime} > create_time
			</if>
			<if test="po.updateTime != null">
				and update_time = #{po.updateTime}
			</if>
			<if test="po.platformId != null">
				and platform_id = #{po.platformId}
			</if>
				<if test="po.enterpriseId != null">
					and enterprise_id = #{po.enterpriseId}
				</if>
				<if test="po.supplierId != null">
					and supplier_id = #{po.supplierId}
				</if>
				
				<if test="po.priceDetail != null">
					and price_detail = #{po.priceDetail}
				</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>			
			<otherwise>
				ORDER BY id desc		
			</otherwise>
		</choose>
	</select>
	
	<select id="productAndProductDescriptionById" resultMap="productCondition">
		SELECT 
		p.id,
		p.brand_id,
		p.product_category,
		p.product_serial_number,
		p.category_tree_node_id,
		p.title,
		p.name,
		p.is_available,
		p.market_price,
		p.chinese_name,
		p.tax_no,
		p.ean_no,
		p.place_of_origin,
		p.calculation_unit,
		p.status,
		p.product_details,
		p.create_time,
		p.update_time,
		p.platform_id,
		p.enterprise_id,
		p.supplier_id,
		p.price_detail,
		p.commodity_template_id,
		p.referlink,
		p.extend,
		pd.content
		from product p
		LEFT JOIN product_description pd on p.id = pd.product_id
		WHERE p.id = #{productId}
	</select>
	
	<select id="findProductByIds" resultMap="productMap">
		select * from product
		where id 
		<include refid="inClause" />
	</select>
	
	<select id="findByCategoryTreeNodeId" resultType="java.lang.Integer">
		SELECT
		count(1) cnt
		FROM product
		where category_tree_node_id = #{categoryTreeNodeId}
	</select>

	<select id="getProductIdsByCondition" resultType="java.lang.Long">
		select id from product
		<where>
			<if test="po.brandId != null">
				and brand_id = #{po.brandId}
			</if>
			<if test="po.categoryTreeNodeId != null">
				and category_tree_node_id = #{po.categoryTreeNodeId}
			</if>
			<if test="po.title != null">
				and title = #{po.title}
			</if>
			<if test="po.name != null">
				and name = #{po.name}
			</if>
			<if test="po.chineseName != null">
				and chinese_name = #{po.chineseName}
			</if>
			<if test="po.taxNo != null">
				and tax_no = #{po.taxNo}
			</if>
			<if test="po.eanNo != null">
				and ean_no = #{po.eanNo}
			</if>
			<if test="po.placeOfOrigin != null">
				and place_of_origin = #{po.placeOfOrigin}
			</if>
			<if test="po.calculationUnit != null">
				and calculation_unit = #{po.calculationUnit}
			</if>
			<if test="po.status != null">
				and status = #{po.status}
			</if>
			<if test="po.productDetails != null">
				and product_details = #{po.productDetails}
			</if>
			<if test="po.createTime != null">
				and create_time = #{po.createTime}
			</if>
			<if test="po.createTime != null">
				and create_time = #{po.createTime}
			</if>
			<if test="po.beginTime != null">
				and  create_time > #{po.beginTime}
			</if>
			<if test="po.finishTime != null">
				and  #{po.finishTime} > create_time
			</if>
			<if test="po.updateTime != null">
				and update_time = #{po.updateTime}
			</if>
			<if test="po.platformId != null">
				and platform_id = #{po.platformId}
			</if>
				<if test="po.enterpriseId != null">
					and enterprise_id = #{po.enterpriseId}
				</if>
				<if test="po.supplierId != null">
					and supplier_id = #{po.supplierId}
				</if>
				
				<if test="po.priceDetail != null">
					and price_detail = #{po.priceDetail}
				</if>
		</where>
	</select>

	<select id="findPrecautiousLines"  resultType="java.lang.String">
		SELECT
		pav.att_value_custom
		FROM
		attribute_name an
		LEFT JOIN product_att_name pan
		on an.id = pan.att_name_id
		LEFT JOIN product_att_value pav
		ON pav.product_att_name_id = pan.id
		WHERE pan.product_id = #{productId} AND an.id
		<include refid="inClause" />
	</select>



	<select id="countOfPageByNameList" resultType="java.lang.Integer">
		SELECT
		count(1) cnt
		from
		( select pro.* from
		( select * from product p,
		( select DISTINCT(pn.product_id) from product_att_name pn, product_att_value pv
		<where>
			<if test="true">
				and pn.id = pv.product_att_name_id
			</if>
			<!--<if test="true">
                and pv.att_value_custom is not null
            </if>-->
			<if test="po.precautiousStart != null or po.precautiousEnd != null ">
				AND pn.att_name_id IN (6,7,8)
			</if>
			<if test="po.precautiousStart != null">
				and CAST(pv.att_value_custom AS SIGNED) &gt;= #{po.precautiousStart}
			</if>
			<if test="po.precautiousEnd != null">
				and CAST(pv.att_value_custom AS SIGNED) &lt;= #{po.precautiousEnd}
			</if>
		</where>
		) a
		where p.id=a.product_id
		) pro  

		<where>
			<if test="true">
				and pro.name is not null
			</if>
			<if test="po.productSerialNumber != null">
				and pro.product_serial_number = #{po.productSerialNumber}
			</if>
			<if test="po.brandId != null">
				and pro.brand_id = #{po.brandId}
			</if>
			<if test="po.categoryTreeNodeId != null">
				and pro.category_tree_node_id = #{po.categoryTreeNodeId}
			</if>
			<if test="po.title != null">
				and pro.title = #{po.title}
			</if>
			<if test="nameList != null">
				<foreach collection="nameList" item="name">
				and pro.name like concat('%',#{name},'%')
				</foreach>
			</if>
			<if test="po.chineseName != null">
				and pro.chinese_name = #{po.chineseName}
			</if>
			<if test="po.taxNo != null">
				and pro.tax_no = #{po.taxNo}
			</if>
			<if test="po.eanNo != null">
				and pro.ean_no = #{po.eanNo}
			</if>
			<if test="po.placeOfOrigin != null">
				and pro.place_of_origin = #{po.placeOfOrigin}
			</if>
			<if test="po.calculationUnit != null">
				and pro.calculation_unit = #{po.calculationUnit}
			</if>
			<if test="po.status != null">
				and pro.status = #{po.status}
			</if>
			<if test="po.isAvailable != null">
				and is_available = #{po.isAvailable}
			</if>
			<if test="po.productDetails != null">
				and pro.product_details = #{po.productDetails}
			</if>
			<if test="po.createTime != null">
				and pro.create_time = #{po.createTime}
			</if>
			<if test="po.beginTime != null">
				and  pro.create_time > #{po.beginTime}
			</if>
			<if test="po.finishTime != null">
				and  #{po.finishTime} > create_time
			</if>
			<if test="po.updateTime != null">
				and pro.update_time = #{po.updateTime}
			</if>
			<if test="po.platformId != null">
				and pro.platform_id = #{po.platformId}
			</if>
				<if test="po.enterpriseId != null">
					and pro.enterprise_id = #{po.enterpriseId}
				</if>
				<if test="po.supplierId != null">
					and pro.supplier_id = #{po.supplierId}
				</if>
				
				<if test="po.priceDetail != null">
					and pro.price_detail = #{po.priceDetail}
				</if>
		</where>

		) proSize
	</select>



	<select id="findOfPageByNameList" resultMap="productMap">
		select pro.* from
		( select * from product p, 
		( select DISTINCT(pn.product_id) from product_att_name pn, product_att_value pv
		<where>
			<if test="true">
				and pn.id = pv.product_att_name_id
			</if>
			<!--<if test="true">
                and pv.att_value_custom is not null
            </if>-->
			<if test="po.precautiousStart != null or po.precautiousEnd != null">
				AND pn.att_name_id IN (6,7,8)
			</if>
			<if test="po.precautiousStart != null">
				and CAST(pv.att_value_custom AS SIGNED) &gt;= #{po.precautiousStart}
			</if>
			<if test="po.precautiousEnd != null">
				and CAST(pv.att_value_custom AS SIGNED) &lt;= #{po.precautiousEnd}
			</if>
		</where>
		) a
		where p.id=a.product_id
		) pro 

		<where>
			<if test="true">
				and pro.name is not null
			</if>
			<if test="po.productSerialNumber != null">
				and pro.product_serial_number = #{po.productSerialNumber}
			</if>
			<if test="po.brandId != null">
				and pro.brand_id = #{po.brandId}
			</if>
			<if test="po.categoryTreeNodeId != null">
				and pro.category_tree_node_id = #{po.categoryTreeNodeId}
			</if>
			<if test="po.title != null">
				and pro.title = #{po.title}
			</if>
			<if test="nameList != null">
				<foreach collection="nameList" item="name">
					and pro.name like concat('%',#{name},'%')
				</foreach>
			</if>
			<if test="po.chineseName != null">
				and pro.chinese_name = #{po.chineseName}
			</if>
			<if test="po.taxNo != null">
				and pro.tax_no = #{po.taxNo}
			</if>
			<if test="po.eanNo != null">
				and pro.ean_no = #{po.eanNo}
			</if>
			<if test="po.placeOfOrigin != null">
				and place_of_origin = #{po.placeOfOrigin}
			</if>
			<if test="po.calculationUnit != null">
				and pro.calculation_unit = #{po.calculationUnit}
			</if>
			<if test="po.status != null">
				and pro.status = #{po.status}
			</if>
			<if test="po.isAvailable != null">
				and is_available = #{po.isAvailable}
			</if>
			<if test="po.productDetails != null">
				and pro.product_details = #{po.productDetails}
			</if>
			<if test="po.createTime != null">
				and pro.create_time = #{po.createTime}
			</if>
			<if test="po.beginTime != null">
				and  pro.create_time > #{po.beginTime}
			</if>
			<if test="po.finishTime != null">
				and  #{po.finishTime} > create_time
			</if>
			<if test="po.updateTime != null">
				and pro.update_time = #{po.updateTime}
			</if>
			<if test="po.platformId != null">
				and pro.platform_id = #{po.platformId}
			</if>
				<if test="po.enterpriseId != null">
					and pro.enterprise_id = #{po.enterpriseId}
				</if>
				<if test="po.supplierId != null">
					and pro.supplier_id = #{po.supplierId}
				</if>
				
				<if test="po.priceDetail != null">
					and pro.price_detail = #{po.priceDetail}
				</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY id desc
			</otherwise>
		</choose>
		<if test="page != null">
			limit #{page.limitStart},#{page.pageSize}
		</if>
	</select>


	<select id="findAllCategoryTreeNodeId"  resultType="java.lang.Long">
		select DISTINCT(category_tree_node_id) from  product
	</select>
</mapper>
	