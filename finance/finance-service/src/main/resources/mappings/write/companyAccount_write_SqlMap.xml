<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.egeo.components.finance.dao.write.CompanyAccountWriteDAO">

	<update id="batchIncreaseAccountBalance" parameterType="com.egeo.components.finance.po.AccountUpdatePO">
		<foreach collection="aus" item="au" separator=";">
			update company_account
			set balance=balance+#{au.sum},
			ciphertext=#{au.cipher}
			<if test="isRecharge">
				,last_recharge_time=CURRENT_TIMESTAMP()
			</if>
			where id=#{au.id}
		</foreach>
	</update>

	<update id="increaseAccountBalance">
		update company_account
		set balance=balance+#{sum},
		ciphertext=md5(concat(balance,#{salt}))
		<if test="isRecharge">
			,last_recharge_time=CURRENT_TIMESTAMP()
		</if>
		where id=#{accountId}
	</update>

	<update id="updateAccountDisable">
		update company_account
		set disabled=#{disabled}
		where
		id=#{id}
	</update>

	<insert id="insert" parameterType="com.egeo.components.finance.po.CompanyAccountPO">
		INSERT INTO company_account(
		<trim suffixOverrides=",">
			<if test="name != null">
				name,
			</if>
			<if test="balance != null">
				balance,
			</if>
			<if test="type != null">
				type,
			</if>
			<if test="companyId != null">
				company_id,
			</if>
			<if test="disabled != null">
				disabled,
			</if>
			<if test="lastRechargeTime != null">
				last_recharge_time,
			</if>
			<if test="createTime != null">
				create_time,
			</if>
			<if test="updateTime != null">
				update_time,
			</if>
			<if test="platformId != null">
				platform_id,
			</if>
			<if test="ciphertext != null">
				ciphertext,
			</if>
			<if test="uuid != null">
				uuid,
			</if>
			<if test="beforeDisableBalance != null">
				before_disabled_balance,
			</if>
		</trim>
		) VALUES (
		<trim suffixOverrides=",">
			<if test="name != null">
				#{name},
			</if>
			<if test="balance != null">
				#{balance},
			</if>
			<if test="type != null">
				#{type},
			</if>
			<if test="companyId != null">
				#{companyId},
			</if>
			<if test="disabled != null">
				#{disabled},
			</if>
			<if test="lastRechargeTime != null">
				#{lastRechargeTime},
			</if>
			<if test="createTime != null">
				#{createTime},
			</if>
			<if test="updateTime != null">
				#{updateTime},
			</if>
			<if test="platformId != null">
				#{platformId},
			</if>
			<if test="ciphertext != null">
				#{ciphertext},
			</if>
			<if test="uuid != null">
				#{uuid},
			</if>
			<if test="beforeDisableBalance != null">
				before_disabled_balance,
			</if>
		</trim>
		)
		<selectKey keyProperty="id" resultType="java.lang.Long">
			select
			LAST_INSERT_ID()
		</selectKey>
	</insert>




	<update id="update">
		UPDATE company_account
		<set>
			<if test="name != null">
				name = #{name},
			</if>
			<if test="balance != null">
				balance = #{balance},
			</if>
			<if test="type != null">
				type = #{type},
			</if>
			<if test="companyId != null">
				company_id = #{companyId},
			</if>
			<if test="disabled != null">
				disabled = #{disabled},
			</if>
			<if test="lastRechargeTime != null">
				last_recharge_time = #{lastRechargeTime},
			</if>
			<if test="createTime != null">
				create_time = #{createTime},
			</if>
			<if test="updateTime != null">
				update_time = #{updateTime},
			</if>
			<if test="platformId != null">
				platform_id=#{platformId},
			</if>
			<if test="ciphertext != null">
				ciphertext=#{ciphertext},
			</if>
			<if test="uuid != null">
				uuid=#{uuid},
			</if>
			<if test="beforeDisableBalance != null">
				before_disabled_balance = #{beforeDisableBalance},
			</if>
		</set>
		WHERE id = #{id}
	</update>


	<delete id="delete">
		delete from company_account where id = #{id}
	</delete>

	<delete id="deleteByPara">
		delete from company_account
		<where>
			<if test="name != null">
				and name = #{name}
			</if>
			<if test="balance != null">
				and balance = #{balance}
			</if>
			<if test="type != null">
				and type = #{type}
			</if>
			<if test="companyId != null">
				and company_id = #{companyId}
			</if>
			<if test="disabled != null">
				and disabled = #{disabled}
			</if>
			<if test="lastRechargeTime != null">
				and last_recharge_time = #{lastRechargeTime}
			</if>
			<if test="createTime != null">
				and create_time = #{createTime}
			</if>
			<if test="updateTime != null">
				and update_time = #{updateTime}
			</if>
			<if test="beforeDisableBalance != null">
				and before_disabled_balance = #{beforeDisableBalance}
			</if>
		</where>
	</delete>


</mapper>
	